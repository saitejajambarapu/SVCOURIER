<% layout("/layouts/boilerplate.ejs") -%>

<div class="container mt-5">
    <h1 class="text-center mb-4">Country Prices</h1>

    <% if (CountryLists.length === 0) { %>
        <!-- Display a message when there are no countries in the list -->
        <div class="alert alert-info text-center">
            <strong>No countries available at the moment.</strong> We're working on updating our country prices. Please check back soon!
        </div>
    <% } else { %>
        <% if(isloggedin){ %>
        <div class="text-center mb-4">
            <!-- Button to Add New Country -->
            <a href="/addNewCountry" class="btn btn-success btn-lg">Add New Country</a>
        </div>
        <% } %>
        <div class="row">
            <!-- Loop through the countries and create a card for each -->
            <% CountryLists.forEach(country => { %>
                <div class="col-md-3 col-sm-6 mb-4">
                    <!-- Bootstrap Card with Image and Styling -->
                    <div class="card card-custom shadow-sm" style="border-radius: 20px;">
                        <!-- Card Image -->
                        <img src="<%= country.image.url %>" class="card-img-top card-image" alt="<%= country.title %>">
                        <div class="card-body text-center">
                            <!-- Card Title (Country Name) -->
                            <h5 class="card-title text-uppercase font-weight-bold"><%= country.title %></h5>
                            <!-- Card Text (Price) -->
                            <p class="card-text price-text">Price Per KG: â‚¹<%= country.price.toFixed(2) %>/KG</p>
                            <p class="card-text">
                                <i>Estimated to be delivered in <b><%= country.Days %></b> days i.e by</i>
                                <!-- Calculate and display the estimated delivery date -->
                                <%= (() => {
                                    const today = new Date();
                                    today.setDate(today.getDate() + country.Days); // Add the number of days to the current date
                                    const options = { year: 'numeric', month: 'long', day: 'numeric' }; // Date format options
                                    return ` ${today.toLocaleDateString('en-IN', options)}`; // Format date in Indian format
                                })() %>
                            </p>
                            <% if(isloggedin){ %>
                                <!-- Edit and Delete Buttons -->
                                <a href="/editCountry/<%= country.id %>" class="btn btn-warning btn-sm">Edit</a>
                                <form action="/deleteCountry/<%= country.id %>" method="POST" style="display:inline;">
                                    <button type="submit" class="btn btn-danger btn-sm ms-5">Delete</button>
                                </form>
                            <% } %>
                            <!-- Button to calculate final price -->
                            <a href="/calculatePrice/<%= country.id %>" class="btn btn-primary btn-sm">Calculate Your Final Price</a>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    <% } %>
</div>

<!-- Custom Styling for the Cards -->
<style>
    /* Card Styles */
    .card-custom {
        border: none;
        background: #f7f9fc;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    /* Hover Effect */
    .card-custom:hover {
        transform: translateY(-10px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
    }

    .card-image {
        border-radius: 15px;
        height: 180px;
        object-fit: cover;
    }

    .price-text {
        font-size: 1.1rem;
        color: #333;
    }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
    }

    .btn-primary:hover {
        background-color: #0056b3;
        border-color: #0056b3;
    }

    .btn-warning {
        background-color: #ffc107;
        border-color: #ffc107;
    }

    .btn-warning:hover {
        background-color: #e0a800;
        border-color: #e0a800;
    }

    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

    .btn-danger:hover {
        background-color: #c82333;
        border-color: #c82333;
    }

    /* Add new country button */
    .btn-lg {
        padding: 12px 30px;
        font-size: 1.1rem;
    }

    .text-uppercase {
        text-transform: uppercase;
    }
</style>

